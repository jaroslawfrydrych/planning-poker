(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1FB5":function(t,e,n){"use strict";n.r(e),n.d(e,"HostModule",(function(){return q}));var o=n("2kYt"),i=n("yDe4"),a=n("PCNd"),r=n("sEIs"),c=n("D57K"),s=n("ZTXN"),b=n("C05f"),l=n("IdLP"),u=n("YtkY"),d=n("l3rL"),g=n("ybPn"),m=n("AzuZ"),h=n("IOsE"),p=n("EM62"),f=n("bwdy"),v=n("Efrr"),O=n("FU6l");function S(t){const{subscriber:e,counter:n,period:o}=t;e.next(n),this.schedule({subscriber:e,counter:n+1,period:o},o)}var C=n("jIqt"),y=n("J+dc"),P=n("PJjB"),k=m.a.SetGameState,M=m.a.SetGameUsers;let w=(()=>{class t{constructor(t,e){this.pokerService=t,this.store=e,this.socketEventsSubscriptions=new f.a,this.gameStateSubject$=new b.a(d.b.IN_PROGRESS),this.gameState$=this.gameStateSubject$.asObservable(),this.hostRoomSubject$=new b.a(null)}get hostRoom(){return this.hostRoomSubject$.getValue()}set hostRoom(t){this.hostRoomSubject$.next(t)}get gameState(){return this.gameStateSubject$.getValue()}set gameState(t){this.gameStateSubject$.next(t)}getUsers(){return this.pokerService.getUsers()}toggleGameState(t){this.pokerService.toggleGameState(t)}currentTime(){return function(t=0,e=v.a){var n;return n=t,(Object(O.a)(n)||!(n-parseFloat(n)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=v.a),new l.a((n=>(n.add(e.schedule(S,t,{subscriber:n,counter:0,period:t})),n)))}(1e3).pipe(Object(C.a)(null),Object(u.a)((()=>new Date)))}getGameState(){return this.pokerService.receiveGameState()}joinSocketRoom(){this.store.select(h.a.roomNumber).pipe(Object(y.a)(1)).subscribe((t=>{this.pokerService.joinRoom(t,d.c.HOST)}))}listenToSocketEvents(){const t=this.getGameState().subscribe((t=>{this.store.dispatch(new k(t))}));this.socketEventsSubscriptions.add(t);const e=this.getUsers().subscribe((t=>{this.store.dispatch(new M(t))}));this.socketEventsSubscriptions.add(e)}closeSocketEvents(){this.socketEventsSubscriptions.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(p.Tb(P.a),p.Tb(i.g))},t.\u0275prov=p.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var j=n("PKRn"),x=n("8j5Y"),_=n("jOdJ");class ${constructor(t,e){this.store=t,this.router=e}navigateToHomePage(){this.router.navigateByUrl("/")}hasRoomNumber(){return this.store.select(h.a.roomNumber).pipe(Object(u.a)((t=>!!t)))}}let R=(()=>{class t extends ${constructor(t,e){super(t,e),this.discardSubject=new s.a}canActivate(){return this.hasRoomNumber().pipe(Object(u.a)((t=>t)),Object(x.a)((t=>{t||this.navigateToHomePage()})))}canDeactivate(t){return t.showLeaveModal(),this.discardSubject.asObservable().pipe(Object(_.a)())}discard(){this.discardSubject.next(!0),setTimeout((()=>{this.discardSubject.next(!0)}))}keep(){this.discardSubject.next(!1)}}return t.\u0275fac=function(e){return new(e||t)(p.Tb(i.g),p.Tb(r.c))},t.\u0275prov=p.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var T=n("9YbD");let A=(()=>{class t{constructor(t){this.environment=t}get production(){return this.environment.production}}return t.\u0275fac=function(e){return new(e||t)(p.Tb(T.a))},t.\u0275prov=p.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var E=n("eM/n"),I=n("zpDr"),N=n("M0Hd"),L=n("M8cf"),G=m.a.ToggleGameState;const V=["roomLinkInput"];function D(t,e){if(1&t&&(p.Nb(0),p.Lb(1,"planning-poker-card",15),p.Zb(2,"async"),p.Mb()),2&t){const t=e.$implicit,n=p.Yb();p.Ab(1),p.ec("boardCard",!0)("gameState",p.ac(2,5,n.gameState$))("card",t.card)("label",t.name)("playerReady",t.status===n.userStatues.VOTED)}}function B(t,e){1&t&&(p.Nb(0),p.mc(1,"New voting"),p.Mb())}function H(t,e){1&t&&(p.Nb(0),p.mc(1,"Finish Voting"),p.Mb())}function K(t,e){1&t&&(p.Nb(0),p.mc(1,"Get room link"),p.Mb())}function Y(t,e){1&t&&(p.Nb(0),p.mc(1,"Link copied"),p.Mb())}function Z(t,e){if(1&t){const t=p.Qb();p.Pb(0,"div",16),p.Lb(1,"div",17),p.Pb(2,"div",18),p.Pb(3,"p"),p.mc(4," Are you sure to end this session? "),p.Ob(),p.Pb(5,"footer",19),p.Pb(6,"button",13),p.Wb("click",(function(){return p.ic(t),p.Yb().leaveModalAction(!0)})),p.mc(7," YES "),p.Ob(),p.Pb(8,"button",13),p.Wb("click",(function(){return p.ic(t),p.Yb().leaveModalAction(!1)})),p.mc(9," NO "),p.Ob(),p.Ob(),p.Ob(),p.Ob()}if(2&t){const t=p.Yb();p.Ab(6),p.ec("buttonColor",t.buttonColors.ACCENT),p.Ab(2),p.ec("buttonColor",t.buttonColors.ACCENT)}}let U=(()=>{class t{constructor(t,e,n,o,i,a,r){this.hostService=t,this.activatedRoute=e,this.$gaService=n,this.boardGuard=o,this.router=i,this.environmentService=a,this.store=r,this.userStatues=d.e,this.gameStates=d.b,this.buttonColors=g.a,this.destroySubject$=new s.a,this.leaveModalVisibilitySubject$=new b.a(!1),this.leaveModalVisibility$=this.leaveModalVisibilitySubject$.asObservable(),this.linkCopiedSubject$=new b.a(!1),this.linkCopied$=this.linkCopiedSubject$.asObservable()}ngOnInit(){this.$gaService.pageView("/host/board"),this.hostService.listenToSocketEvents(),this.hostService.joinSocketRoom(),this.currentTime$=this.hostService.currentTime()}ngOnDestroy(){this.destroySubject$.next(null),this.hostService.closeSocketEvents()}beforeUnloadHandler(t){if(this.environmentService.production)return!1}set leaveModalVisibility(t){this.leaveModalVisibilitySubject$.next(t)}get roomLink$(){return this.roomNumber$.pipe(Object(u.a)((t=>window.location.origin+"/guest/room-code?code="+t)))}toggleGameState(){this.$gaService.event("toggle_game_state","host","Toggle game state"),this.store.dispatch(new G)}getRoomLink(){this.roomLinkInput.nativeElement.select(),this.roomLinkInput.nativeElement.setSelectionRange(0,99999),document.execCommand("copy"),this.roomLinkInput.nativeElement.blur(),this.linkCopiedSubject$.next(!0),setTimeout((()=>{this.linkCopiedSubject$.next(!1)}),2e3)}closeRoom(){this.router.navigateByUrl("/")}showLeaveModal(){this.leaveModalVisibility=!0}closeLeaveModal(){this.leaveModalVisibility=!1}leaveModalAction(t){t?this.boardGuard.discard():this.boardGuard.keep(),this.closeLeaveModal()}}return t.\u0275fac=function(e){return new(e||t)(p.Kb(w),p.Kb(r.a),p.Kb(j.a),p.Kb(R),p.Kb(r.c),p.Kb(A),p.Kb(i.g))},t.\u0275cmp=p.Eb({type:t,selectors:[["planning-poker-board"]],viewQuery:function(t,e){var n;1&t&&p.pc(V,!0),2&t&&p.fc(n=p.Xb())&&(e.roomLinkInput=n.first)},hostBindings:function(t,e){1&t&&p.Wb("beforeunload",(function(){return e.beforeUnloadHandler()}),!1,p.hc)},decls:30,vars:29,consts:[[1,"cards"],[4,"ngFor","ngForOf"],[1,"sidebar"],[1,"sidebar-header"],["planningPokerTextFixedWidth",""],[1,"room-link-input",3,"value"],["roomLinkInput",""],[1,"clock",3,"value"],[1,"sidebar-footer"],["planningPokerButton","",1,"toggle-game-state",3,"buttonColor","ngSwitch","click"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["planningPokerButton","",3,"buttonColor","ngSwitch","click"],["planningPokerButton","",3,"buttonColor","click"],["class","modal-container",4,"ngIf"],[3,"boardCard","gameState","card","label","playerReady"],[1,"modal-container"],[1,"modal-overlay"],[1,"modal-content"],[1,"modal-footer"]],template:function(t,e){1&t&&(p.Pb(0,"div",0),p.lc(1,D,3,7,"ng-container",1),p.Zb(2,"async"),p.Ob(),p.Pb(3,"div",2),p.Pb(4,"header",3),p.Pb(5,"h1"),p.mc(6,"ROOM ID:"),p.Ob(),p.Pb(7,"h2",4),p.mc(8),p.Zb(9,"async"),p.Ob(),p.Lb(10,"input",5,6),p.Zb(12,"async"),p.Lb(13,"planning-poker-text-fixed-width",7),p.Zb(14,"date"),p.Zb(15,"async"),p.Ob(),p.Pb(16,"footer",8),p.Pb(17,"button",9),p.Wb("click",(function(){return e.toggleGameState()})),p.Zb(18,"async"),p.lc(19,B,2,0,"ng-container",10),p.lc(20,H,2,0,"ng-container",11),p.Ob(),p.Pb(21,"button",12),p.Wb("click",(function(){return e.getRoomLink()})),p.Zb(22,"async"),p.lc(23,K,2,0,"ng-container",11),p.lc(24,Y,2,0,"ng-container",10),p.Ob(),p.Pb(25,"button",13),p.Wb("click",(function(){return e.closeRoom()})),p.Nb(26),p.mc(27,"Close room"),p.Mb(),p.Ob(),p.Ob(),p.Ob(),p.lc(28,Z,10,2,"div",14),p.Zb(29,"async")),2&t&&(p.Ab(1),p.ec("ngForOf",p.ac(2,12,e.users$)),p.Ab(7),p.nc(p.ac(9,14,e.roomNumber$)),p.Ab(2),p.ec("value",p.ac(12,16,e.roomLink$)),p.Ab(3),p.ec("value",p.bc(14,18,p.ac(15,21,e.currentTime$),"HH:mm")),p.Ab(4),p.ec("buttonColor",e.buttonColors.PRIMARY)("ngSwitch",p.ac(18,23,e.gameState$)),p.Ab(2),p.ec("ngSwitchCase",e.gameStates.REVIEW),p.Ab(2),p.ec("buttonColor",e.buttonColors.SECONDARY)("ngSwitch",p.ac(22,25,e.linkCopied$)),p.Ab(3),p.ec("ngSwitchCase",!0),p.Ab(1),p.ec("buttonColor",e.buttonColors.INACTIVE),p.Ab(3),p.ec("ngIf",p.ac(29,27,e.leaveModalVisibility$)))},directives:[o.j,E.a,I.a,N.a,o.l,o.m,o.n,o.k,L.a],pipes:[o.b,o.e],styles:["[_nghost-%COMP%]{padding:0 1.1111111111em;width:100%;height:100%;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-content:stretch;align-items:flex-start}.room-link-input[_ngcontent-%COMP%]{opacity:0}.cards[_ngcontent-%COMP%]{order:0;flex:1 1 auto;align-self:auto;height:100%;width:100%;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start;align-content:flex-start;align-items:flex-start;overflow:auto;padding-right:.8333333333em}.cards[_ngcontent-%COMP%]   planning-poker-card[_ngcontent-%COMP%]{margin:2.7777777778em 1% 1%}.sidebar[_ngcontent-%COMP%]{flex:0 0 27%;flex-direction:column;flex-wrap:nowrap;justify-content:flex-start;align-content:stretch;align-items:flex-start;height:100%;padding-top:2.5em;padding-left:.8333333333em}.sidebar[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{order:0;align-self:auto;display:flex}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{flex:1 1 auto;flex-direction:column;width:100%}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8333333333em;letter-spacing:.0833333333em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.8888888889em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .clock[_ngcontent-%COMP%]{margin-top:auto;margin-left:auto;color:#fff;font-size:1.8333333333em;font-weight:700}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:flex-start;width:100%}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:1.6666666667em 0;width:100%}.modal-container[_ngcontent-%COMP%]{position:fixed;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;z-index:99}.modal-container[_ngcontent-%COMP%]   .modal-overlay[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;background:rgba(27,28,42,.8)}.modal-container[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{position:relative;background-color:#f0ca20;color:#1b1c2a;height:11.1111111111em;width:27.7777777778em;padding:1.6666666667em;align-items:center;justify-content:center;display:flex;flex-direction:column}.modal-container[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1111111111em;text-transform:uppercase;font-weight:700}.modal-container[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-top:auto}.modal-container[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button.planning-poker-button[_ngcontent-%COMP%]{margin:0 .8333333333em;min-width:10em;height:3.3333333333em}"]}),Object(c.b)([Object(i.d)(h.a.gameState),Object(c.c)("design:type",l.a)],t.prototype,"gameState$",void 0),Object(c.b)([Object(i.d)(h.a.roomNumber),Object(c.c)("design:type",l.a)],t.prototype,"roomNumber$",void 0),Object(c.b)([Object(i.d)(h.a.users),Object(c.c)("design:type",l.a)],t.prototype,"users$",void 0),t})();var W=n("BwBJ"),z=n("kuMc"),F=n("W79N"),J=m.a.CreateRoom;const Q=[{path:"wait",component:(()=>{class t{constructor(t,e,n){this.router=t,this.store=e,this.$gaService=n,this.destroySubject=new s.a}ngOnInit(){this.$gaService.pageView("/host/board"),this.store.dispatch(new J).pipe(Object(W.a)(1500),Object(z.a)(this.destroySubject)).subscribe((()=>this.router.navigateByUrl("/host/board")))}ngOnDestroy(){this.destroySubject.next(null)}}return t.\u0275fac=function(e){return new(e||t)(p.Kb(r.c),p.Kb(i.g),p.Kb(j.a))},t.\u0275cmp=p.Eb({type:t,selectors:[["planning-poker-wait"]],decls:4,vars:0,consts:[[1,"loop-loader"]],template:function(t,e){1&t&&(p.Pb(0,"planning-poker-icon",0),p.mc(1," loop\n"),p.Ob(),p.Pb(2,"p"),p.mc(3,"Creating room..."),p.Ob())},directives:[F.a],styles:["@keyframes rotate{0%{transform:rotate(1turn)}50%{transform:rotate(180deg)}to{transform:rotate(0deg)}}[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}p[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase;font-size:1em;font-weight:700}.loop-loader[_ngcontent-%COMP%]     .material-icons{font-size:2.7777777778em;animation-name:rotate;animation-duration:1s;animation-iteration-count:infinite}"]}),t})(),canActivate:[(()=>{class t extends ${constructor(t,e){super(t,e)}canActivate(){return this.hasRoomNumber().pipe(Object(u.a)((t=>!t)),Object(x.a)((t=>{t||this.navigateToHomePage()})))}}return t.\u0275fac=function(e){return new(e||t)(p.Tb(i.g),p.Tb(r.c))},t.\u0275prov=p.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()],data:{animation:"WaitComponent"}},{path:"board",component:U,canActivate:[R],canDeactivate:[R],data:{animation:"BoardComponent"}},{path:"**",redirectTo:"wait"}];let X=(()=>{class t{}return t.\u0275mod=p.Ib({type:t}),t.\u0275inj=p.Hb({factory:function(e){return new(e||t)},imports:[[r.d.forChild(Q)],r.d]}),t})(),q=(()=>{class t{}return t.\u0275mod=p.Ib({type:t}),t.\u0275inj=p.Hb({factory:function(e){return new(e||t)},imports:[[o.c,X,a.a,i.c.forFeature([h.a])]]}),t})()}}]);