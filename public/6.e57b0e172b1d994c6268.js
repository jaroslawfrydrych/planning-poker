(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1FB5":function(e,t,o){"use strict";o.r(t),o.d(t,"HostModule",(function(){return me}));var n=o("2kYt"),i=o("yDe4"),c=o("PCNd"),a=o("sEIs"),r=o("D57K"),s=o("C05f"),b=o("IdLP"),l=o("Efrr"),d=o("FU6l");function u(e){const{subscriber:t,counter:o,period:n}=e;t.next(o),this.schedule({subscriber:t,counter:o+1,period:n},n)}var p=o("5uGe");class g{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new m(e,this.dueTime,this.scheduler))}}class m extends p.a{constructor(e,t,o){super(e),this.dueTime=t,this.scheduler=o,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(h,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function h(e){e.debouncedNext()}var O=o("xVbo"),f=o("jIqt"),y=o("YtkY"),j=o("l3rL"),v=o("ybPn"),S=o("QvUv"),C=o("EM62");let P=(()=>{class e{copyText(e){const t=this.createInputElement();t.style.opacity="0",t.style["text-indent"]="-9999px",document.body.appendChild(t),this.setInputValue(t,e),this.selectInput(t),document.execCommand("copy"),this.removeElement(t)}createInputElement(){return document.createElement("input")}selectInput(e){e.select(),e.setSelectionRange(0,99999)}setInputValue(e,t){e.value=t}removeElement(e){e.blur(),e.remove()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=C.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var M,w=o("jJz7");!function(e){class t{}t.type="[HostActions] Host board initialization",e.HostBoardInit=t;class o{}o.type="[HostActions] Create room",e.CreateRoom=o;class n{}n.type="[HostActions] Toggle Game State",e.ToggleGameState=n;class i{}i.type="[HostActions] Join room",e.JoinRoom=i;class c{}c.type="[HostActions] Get players",e.GetPlayers=c;class a{}a.type="[HostActions] Get game state",e.GetGameState=a;class r{}r.type="[HostActions] Copy room link",e.CopyRoomLink=r;class s{}s.type="[HostActions] Close room",e.CloseRoom=s}(M||(M={}));var k=o("8j5Y"),x=o("cJ9h"),_=o("kuMc"),R=o("PJjB");let A=(()=>{class e{constructor(e){this.pokerService=e}createRoom(){return this.pokerService.createRoom()}joinRoom(e){this.pokerService.joinRoom(e,j.d.HOST)}getUsers(){return this.pokerService.getUsers()}getGameState(){return this.pokerService.getGameState()}toggleGameState(e){return this.pokerService.toggleGameState(e)}closeRoom(e){this.pokerService.closeRoom(e)}}return e.\u0275fac=function(t){return new(t||e)(C.Tb(R.a))},e.\u0275prov=C.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=o("PKRn"),G=M.CloseRoom,N=M.CreateRoom,$=M.GetGameState,I=M.GetPlayers,H=M.JoinRoom,V=M.ToggleGameState,F=M.HostBoardInit,E=M.CopyRoomLink;let L=(()=>{let e=class{constructor(e,t,o){this.hostService=e,this.$gaService=t,this.actions$=o}static gameState(e){return e.gameState}static roomNumber(e){return e.roomNumber}static players(e){return e.players}hostBoardInit(){this.$gaService.pageView("/host/board")}createRoom(e){return this.hostService.createRoom().pipe(Object(k.a)((t=>{const o=e.getState();e.setState(Object.assign(Object.assign({},o),{roomNumber:t.id,gameState:t.gameState}))})),Object(x.a)((()=>e.dispatch(new H))))}toggleHostState(e){this.$gaService.event("toggle_game_state","host","Toggle game state");const t=e.getState();this.hostService.toggleGameState(t.roomNumber)}joinRoom(e){const t=e.getState();this.hostService.joinRoom(t.roomNumber)}getUsers(e){this.hostService.getUsers().pipe(Object(_.a)(this.actions$.pipe(Object(i.j)(G)))).subscribe((t=>{e.patchState({players:t})}))}getGameState(e){this.hostService.getGameState().pipe(Object(_.a)(this.actions$.pipe(Object(i.j)(G)))).subscribe((t=>{e.patchState({gameState:t})}))}copyRoomLink(){this.$gaService.event("copy_room_link","host","Copy room link")}closeRoom(e){const t=e.getState();this.$gaService.event("close_room","host","Close room"),this.hostService.closeRoom(t.roomNumber)}};return e.\u0275fac=function(t){return new(t||e)(C.Tb(A),C.Tb(T.a),C.Tb(i.b))},e.\u0275prov=C.Gb({token:e,factory:e.\u0275fac}),Object(r.b)([Object(i.a)(F),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[]),Object(r.c)("design:returntype",void 0)],e.prototype,"hostBoardInit",null),Object(r.b)([Object(i.a)(N),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",b.a)],e.prototype,"createRoom",null),Object(r.b)([Object(i.a)(V),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",void 0)],e.prototype,"toggleHostState",null),Object(r.b)([Object(i.a)(H),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",void 0)],e.prototype,"joinRoom",null),Object(r.b)([Object(i.a)(I),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",void 0)],e.prototype,"getUsers",null),Object(r.b)([Object(i.a)($),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",void 0)],e.prototype,"getGameState",null),Object(r.b)([Object(i.a)(E),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[]),Object(r.c)("design:returntype",void 0)],e.prototype,"copyRoomLink",null),Object(r.b)([Object(i.a)(G),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",void 0)],e.prototype,"closeRoom",null),Object(r.b)([Object(i.f)(),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",String)],e,"gameState",null),Object(r.b)([Object(i.f)(),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",String)],e,"roomNumber",null),Object(r.b)([Object(i.f)(),Object(r.c)("design:type",Function),Object(r.c)("design:paramtypes",[Object]),Object(r.c)("design:returntype",Array)],e,"players",null),e=Object(r.b)([Object(i.g)({name:"host",defaults:{roomNumber:null,gameState:j.b.IN_PROGRESS,players:[]}})],e),e})();var B=o("ZTXN"),D=o("jOdJ");class U{constructor(e,t){this.store=e,this.router=t}navigateToHomePage(){this.router.navigateByUrl("/")}hasRoomNumber(){return this.store.select(L.roomNumber).pipe(Object(y.a)((e=>!!e)))}}let z=(()=>{class e extends U{constructor(e,t){super(e,t),this.discardSubject=new B.a}canActivate(){return this.hasRoomNumber().pipe(Object(y.a)((e=>e)),Object(k.a)((e=>{e||this.navigateToHomePage()})))}canDeactivate(e){return e.showLeaveModal(),this.discardSubject.asObservable().pipe(Object(D.a)())}discard(){this.discardSubject.next(!0),setTimeout((()=>{this.discardSubject.next(!0)}))}keep(){this.discardSubject.next(!1)}}return e.\u0275fac=function(t){return new(t||e)(C.Tb(i.h),C.Tb(a.c))},e.\u0275prov=C.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Y=o("rdFE"),J=o("eM/n"),K=o("zpDr"),W=o("M0Hd"),Z=o("M8cf"),Q=M.CloseRoom,q=M.GetGameState,X=M.GetPlayers,ee=M.ToggleGameState,te=M.HostBoardInit,oe=M.CopyRoomLink;function ne(e,t){if(1&e&&(C.Nb(0),C.Lb(1,"planning-poker-card",14),C.Zb(2,"async"),C.Mb()),2&e){const e=t.$implicit,o=C.Yb();C.Ab(1),C.ec("boardCard",!0)("gameState",C.ac(2,5,o.gameState$))("card",e.card)("label",e.name)("playerReady",e.status===o.userStatues.VOTED)}}function ie(e,t){1&e&&(C.Nb(0),C.nc(1,"New voting"),C.Mb())}function ce(e,t){1&e&&(C.Nb(0),C.nc(1,"Finish Voting"),C.Mb())}function ae(e,t){1&e&&(C.Nb(0),C.nc(1,"Get room link"),C.Mb())}function re(e,t){1&e&&(C.Nb(0),C.nc(1,"Link copied"),C.Mb())}function se(e,t){if(1&e){const e=C.Qb();C.Pb(0,"div",15),C.Lb(1,"div",16),C.Pb(2,"div",17),C.Pb(3,"p"),C.nc(4," Are you sure to end this session? "),C.Ob(),C.Pb(5,"footer",18),C.Pb(6,"button",12),C.Wb("click",(function(){return C.ic(e),C.Yb().leaveModalAction(!0)})),C.nc(7," YES "),C.Ob(),C.Pb(8,"button",12),C.Wb("click",(function(){return C.ic(e),C.Yb().leaveModalAction(!1)})),C.nc(9," NO "),C.Ob(),C.Ob(),C.Ob(),C.Ob()}if(2&e){const e=C.Yb();C.Ab(6),C.ec("buttonColor",e.buttonColors.ACCENT),C.Ab(2),C.ec("buttonColor",e.buttonColors.ACCENT)}}let be=(()=>{let e=class{constructor(e,t,o,n,i){this.boardGuard=e,this.router=t,this.environmentService=o,this.copyToClipboardService=n,this.store=i,this.gameStates=j.b,this.userStatues=j.c,this.buttonColors=v.a,this.leaveModalVisibilitySubject$=new s.a(!1),this.leaveModalVisibility$=this.leaveModalVisibilitySubject$.asObservable(),this.linkCopiedSubject$=new s.a(!1),this.linkCopied$=this.linkCopiedSubject$.asObservable()}ngOnInit(){this.dispatchOnInitActions(),this.store.dispatch(new te),this.currentTime$=this.getCurrentTime$()}ngOnDestroy(){this.dispatchOnDestroyActions()}toggleGameState(){this.store.dispatch(new ee)}closeRoom(){this.router.navigateByUrl("/")}set leaveModalVisibility(e){this.leaveModalVisibilitySubject$.next(e)}get roomLink(){const e=this.store.selectSnapshot(L.roomNumber);return window.location.origin+"/guest/room-code?code="+e}copyToClipboardRoomLink(){this.store.dispatch(new oe),this.copyToClipboardService.copyText(this.roomLink),this.linkCopiedSubject$.next(!0),this.linkCopied$.pipe(function(e,t=l.a){return o=>o.lift(new g(e,t))}(2e3),Object(O.a)((e=>e)),Object(S.b)(this)).subscribe((()=>{this.linkCopiedSubject$.next(!1)}))}showLeaveModal(){this.leaveModalVisibility=!0}closeLeaveModal(){this.leaveModalVisibility=!1}leaveModalAction(e){e?this.boardGuard.discard():this.boardGuard.keep(),this.closeLeaveModal()}beforeUnloadHandler(){if(this.environmentService.production)return!1}dispatchOnInitActions(){this.store.dispatch([new X,new q])}dispatchOnDestroyActions(){this.store.dispatch(new Q)}getCurrentTime$(){return function(e=0,t=l.a){var o;return o=e,(Object(d.a)(o)||!(o-parseFloat(o)+1>=0)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=l.a),new b.a((o=>(o.add(t.schedule(u,e,{subscriber:o,counter:0,period:e})),o)))}(1e3).pipe(Object(f.a)(null),Object(y.a)((()=>new Date)))}};return e.\u0275fac=function(t){return new(t||e)(C.Kb(z),C.Kb(a.c),C.Kb(w.a),C.Kb(P),C.Kb(i.h))},e.\u0275cmp=C.Eb({type:e,selectors:[["planning-poker-board"]],hostBindings:function(e,t){1&e&&C.Wb("beforeunload",(function(){return t.beforeUnloadHandler()}),!1,C.hc)},decls:29,vars:29,consts:[[1,"cards"],["label","Andrzej",3,"gameState"],[4,"ngFor","ngForOf"],[1,"sidebar"],[1,"sidebar-header"],["planningPokerTextFixedWidth",""],[1,"clock",3,"value"],[1,"sidebar-footer"],["planningPokerButton","",1,"toggle-game-state",3,"buttonColor","ngSwitch","click"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["planningPokerButton","",3,"buttonColor","ngSwitch","click"],["planningPokerButton","",3,"buttonColor","click"],["class","modal-container",4,"ngIf"],[3,"boardCard","gameState","card","label","playerReady"],[1,"modal-container"],[1,"modal-overlay"],[1,"modal-content"],[1,"modal-footer"]],template:function(e,t){1&e&&(C.Pb(0,"div",0),C.Lb(1,"planning-poker-card-item",1),C.Zb(2,"async"),C.lc(3,ne,3,7,"ng-container",2),C.Zb(4,"async"),C.Ob(),C.Pb(5,"div",3),C.Pb(6,"header",4),C.Pb(7,"h1"),C.nc(8,"ROOM ID:"),C.Ob(),C.Pb(9,"h2",5),C.nc(10),C.Zb(11,"async"),C.Ob(),C.Lb(12,"planning-poker-text-fixed-width",6),C.Zb(13,"date"),C.Zb(14,"async"),C.Ob(),C.Pb(15,"footer",7),C.Pb(16,"button",8),C.Wb("click",(function(){return t.toggleGameState()})),C.Zb(17,"async"),C.lc(18,ie,2,0,"ng-container",9),C.lc(19,ce,2,0,"ng-container",10),C.Ob(),C.Pb(20,"button",11),C.Wb("click",(function(){return t.copyToClipboardRoomLink()})),C.Zb(21,"async"),C.lc(22,ae,2,0,"ng-container",10),C.lc(23,re,2,0,"ng-container",9),C.Ob(),C.Pb(24,"button",12),C.Wb("click",(function(){return t.closeRoom()})),C.Nb(25),C.nc(26,"Close room"),C.Mb(),C.Ob(),C.Ob(),C.Ob(),C.lc(27,se,10,2,"div",13),C.Zb(28,"async")),2&e&&(C.Ab(1),C.ec("gameState",C.ac(2,12,t.gameState$)),C.Ab(2),C.ec("ngForOf",C.ac(4,14,t.players$)),C.Ab(7),C.oc(C.ac(11,16,t.roomNumber$)),C.Ab(2),C.ec("value",C.bc(13,18,C.ac(14,21,t.currentTime$),"HH:mm")),C.Ab(4),C.ec("buttonColor",t.buttonColors.PRIMARY)("ngSwitch",C.ac(17,23,t.gameState$)),C.Ab(2),C.ec("ngSwitchCase",t.gameStates.REVIEW),C.Ab(2),C.ec("buttonColor",t.buttonColors.SECONDARY)("ngSwitch",C.ac(21,25,t.linkCopied$)),C.Ab(3),C.ec("ngSwitchCase",!0),C.Ab(1),C.ec("buttonColor",t.buttonColors.INACTIVE),C.Ab(3),C.ec("ngIf",C.ac(28,27,t.leaveModalVisibility$)))},directives:[Y.a,n.j,J.a,K.a,W.a,n.l,n.m,n.n,n.k,Z.a],pipes:[n.b,n.e],styles:["[_nghost-%COMP%]{padding:0 1.1111111111em;flex-direction:row;flex-wrap:nowrap;align-content:stretch}.cards[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;height:100%;display:flex;justify-content:flex-start;align-items:flex-start}.cards[_ngcontent-%COMP%]{order:0;flex:1 1 auto;align-self:auto;overflow:auto;padding-right:.8333333333em;flex-direction:row;flex-wrap:wrap;align-content:flex-start}.sidebar[_ngcontent-%COMP%]{flex:0 0 27%;flex-direction:column;flex-wrap:nowrap;justify-content:flex-start;align-content:stretch;align-items:flex-start;height:100%;padding-top:2.5em;padding-left:.8333333333em}.sidebar[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{order:0;align-self:auto;display:flex}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{flex:1 1 auto;flex-direction:column;width:100%}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8333333333em;letter-spacing:.0833333333em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.8888888889em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .clock[_ngcontent-%COMP%]{margin-top:auto;margin-left:auto;color:#fff;font-size:1.8333333333em;font-weight:700}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:flex-start;width:100%}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:1.6666666667em 0;width:100%}.modal-container[_ngcontent-%COMP%]{position:fixed;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;z-index:99}.modal-container[_ngcontent-%COMP%]   .modal-overlay[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;background:rgba(27,28,42,.8)}.modal-container[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{position:relative;background-color:#f0ca20;color:#1b1c2a;height:11.1111111111em;width:27.7777777778em;padding:1.6666666667em;align-items:center;justify-content:center;display:flex;flex-direction:column}.modal-container[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1111111111em;text-transform:uppercase;font-weight:700}.modal-container[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-top:auto}.modal-container[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button.planning-poker-button[_ngcontent-%COMP%]{margin:0 .8333333333em;min-width:10em;height:3.3333333333em}"]}),Object(r.b)([Object(i.e)(L.gameState),Object(r.c)("design:type",b.a)],e.prototype,"gameState$",void 0),Object(r.b)([Object(i.e)(L.roomNumber),Object(r.c)("design:type",b.a)],e.prototype,"roomNumber$",void 0),Object(r.b)([Object(i.e)(L.players),Object(r.c)("design:type",b.a)],e.prototype,"players$",void 0),e=Object(r.b)([Object(S.a)()],e),e})();var le=o("BwBJ"),de=o("W79N"),ue=M.CreateRoom;const pe=[{path:"wait",component:(()=>{let e=class{constructor(e,t,o){this.router=e,this.store=t,this.$gaService=o}ngOnInit(){this.$gaService.pageView("/host/board"),this.store.dispatch(new ue).pipe(Object(le.a)(1500),Object(S.b)(this)).subscribe((()=>this.router.navigateByUrl("/host/board")))}};return e.\u0275fac=function(t){return new(t||e)(C.Kb(a.c),C.Kb(i.h),C.Kb(T.a))},e.\u0275cmp=C.Eb({type:e,selectors:[["planning-poker-wait"]],decls:4,vars:0,consts:[[1,"loop-loader"]],template:function(e,t){1&e&&(C.Pb(0,"planning-poker-icon",0),C.nc(1," loop\n"),C.Ob(),C.Pb(2,"p"),C.nc(3,"Creating room..."),C.Ob())},directives:[de.a],styles:["@keyframes rotate{0%{transform:rotate(1turn)}50%{transform:rotate(180deg)}to{transform:rotate(0deg)}}[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}p[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase;font-size:1em;font-weight:700}.loop-loader[_ngcontent-%COMP%]     .material-icons{font-size:2.7777777778em;animation-name:rotate;animation-duration:1s;animation-iteration-count:infinite}"]}),e=Object(r.b)([Object(S.a)()],e),e})(),canActivate:[(()=>{class e extends U{constructor(e,t){super(e,t)}canActivate(){return this.hasRoomNumber().pipe(Object(y.a)((e=>!e)),Object(k.a)((e=>{e||this.navigateToHomePage()})))}}return e.\u0275fac=function(t){return new(t||e)(C.Tb(i.h),C.Tb(a.c))},e.\u0275prov=C.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()],data:{animation:"WaitComponent"}},{path:"board",component:be,canActivate:[z],canDeactivate:[z],data:{animation:"BoardComponent"}},{path:"**",redirectTo:"wait"}];let ge=(()=>{class e{}return e.\u0275mod=C.Ib({type:e}),e.\u0275inj=C.Hb({factory:function(t){return new(t||e)},imports:[[a.d.forChild(pe)],a.d]}),e})(),me=(()=>{class e{}return e.\u0275mod=C.Ib({type:e}),e.\u0275inj=C.Hb({factory:function(t){return new(t||e)},imports:[[n.c,ge,c.a,i.d.forFeature([L])]]}),e})()}}]);