(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1FB5":function(e,t,n){"use strict";n.r(t),n.d(t,"HostModule",(function(){return pt}));var o=n("2kYt"),s=n("yDe4"),r=n("IdLP"),i=n("bwdy"),c=n("QQZH"),a=n("ROBh"),b=n("GoAz"),l=n("C05f"),u=n("ZTXN"),p=n("Ohay"),d=n("TLy2"),h=n("YtkY"),m=n("8j5Y"),g=n("wqq/"),O=n("xVbo"),f=n("pBDD"),j=n("mW0F");class y{constructor(e,t){this.observables=e,this.project=t}call(e,t){return t.subscribe(new v(e,this.observables,this.project))}}class v extends f.a{constructor(e,t,n){super(e),this.observables=t,this.project=n,this.toRespond=[];const o=t.length;this.values=new Array(o);for(let s=0;s<o;s++)this.toRespond.push(s);for(let s=0;s<o;s++){let e=t[s];this.add(Object(j.a)(this,e,e,s))}}notifyNext(e,t,n,o,s){this.values[n]=t;const r=this.toRespond;if(r.length>0){const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}notifyComplete(){}_next(e){if(0===this.toRespond.length){const t=[e,...this.values];this.project?this._tryProject(t):this.destination.next(t)}}_tryProject(e){let t;try{t=this.project.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}n("3lSR");var S=n("EM62");function C(e){const t=new WeakMap;return{getProps:n,setProps:function(e,o){const s=n(e);return Object.entries(o).forEach((([e,t])=>{s[e]=t})),t.set(e,s),s}};function n(n){const o=e(n),s=t.get(n);let r;return void 0!==s?r=s:(r={},Object.entries(o).forEach((([e,t])=>{r[e]=function(e,t){return null!=e[t]}(n,e)?n[e]:t})),t.set(n,r)),r}}const w=x(),k=C((e=>({numCoalescingSubscribers:0})));function x(){return{remove:function(e){const t=k.getProps(e).numCoalescingSubscribers-1;k.setProps(e,{numCoalescingSubscribers:t})},add:function(e){const t=k.getProps(e).numCoalescingSubscribers+1;k.setProps(e,{numCoalescingSubscribers:t})},isCoalescing:function(e){return k.getProps(e).numCoalescingSubscribers>0}}}function R(e,t){const n=t||{};return t=>new r.a((o=>{const s=new i.a;return s.add(t.subscribe(function(t,o){let s,r;const i=()=>{w.remove(n),w.isCoalescing(n)||t.next(r)};return{complete:()=>{s&&i(),t.complete()},error:e=>t.error(e),next:t=>{r=t,s||(w.add(n),s=e.subscribe({next:()=>{i(),s=void 0},complete:()=>{s&&(i(),s=void 0)}}),o.add(s))}}}(o,s))),s}))}function P(e,t){return function(e,t){return void 0!==t["__zone_symbol__"+e]}(e,t=t||window||self||globalThis)?t["__zone_symbol__"+e]:t[e]}let I=null;function _(){return I=I||P("Promise").resolve(),I}var T=function(e){return e.background="background",e.userBlocking="user-blocking",e.userVisible="user-visible",e}({});const M="undefined"!=typeof window?window.scheduler||{postTask:e=>(Date.now(),new Promise((e=>{setTimeout((function(){console.error("postTask not implemented. Use setTimeout as fallback"),e()}),1)})))}:()=>{},$=()=>new r.a((e=>{const t=window.__zone_symbol__setTimeout((()=>{e.next(0),e.complete()}));return()=>{window.__zone_symbol__clearTimeout(t)}})),A="undefined"!=typeof window?window.cancelIdleCallback||function(e){console.warn("Fake cancelIdleCallback used"),clearTimeout(e)}:()=>{},N="undefined"!=typeof window?window.requestIdleCallback||function(e){console.warn("Fake requestIdleCallback used");const t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)}:()=>{},F=()=>new r.a((e=>{const t=N((()=>{e.next(0),e.complete()}));return()=>A(t)})),E=e=>new r.a((t=>(M.postTask((()=>{}),e).then((()=>{t.next(0),t.complete()})),()=>{})));const G=()=>new r.a((e=>{let t=!1;return _().then((()=>{t||(e.next(0),e.complete())})).catch((t=>{e.error(t)})),()=>{t=!0,e.complete()}})),H={animationFrame:(()=>new r.a((e=>{const t=P("requestAnimationFrame")((()=>{e.next(0),e.complete()}));return()=>{P("cancelAnimationFrame")(t)}})))(),Promise:G(),setInterval:$(),idleCallback:F(),userBlocking:E({priority:T.userBlocking}),userVisible:E({priority:T.userVisible}),background:E({priority:T.background})};function D(e,t,n={},o=new AbortController){const s=function(e,t,n={},o=new AbortController){let s;if(!w.isCoalescing(n)){w.add(n),s=t.subscribe((()=>{w.remove(n),w.isCoalescing(n)||e()}));const r=function(){s.unsubscribe(),o.signal.removeEventListener("abort",r,!1)};o.signal.addEventListener("abort",r,!1)}return o}((()=>function(e,t,n=new AbortController){if(!1===t)return r(),n;const o=H[t].subscribe({complete:()=>n.abort(),next:()=>r()}),s=function(){o.unsubscribe(),n.signal.removeEventListener("abort",s,!1)};return n.signal.addEventListener("abort",s,!1),n;function r(){n.signal.aborted||(e(),n.abort())}}(e,t,o)),Object(b.a)(_()),n,o),r=function(){s.abort(),o.signal.removeEventListener("abort",r,!1)};return o.signal.addEventListener("abort",r,!1),o}let V=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)}}),e})();function B(e){return{name:"native",detectChanges:()=>e.cdRef.markForCheck(),rxScheduleCD:t=>t.pipe(Object(m.a)((()=>{e.cdRef.markForCheck()}))),scheduleCD:()=>(e.cdRef.markForCheck(),new AbortController)}}var L=function(e){return e.animationFrame="animationFrame",e.Promise="Promise",e.idleCallback="idleCallback",e.userBlocking="userBlocking",e.userVisible="userVisible",e.background="background",e.setInterval="setInterval",e}({});const U=G();function Q(e){const t=e.cdRef.context,n=L.animationFrame,o=H[n],s=()=>{e.cdRef.detectChanges()};return{name:"local",detectChanges:s,rxScheduleCD:e=>e.pipe(R(U,t),Object(d.a)((e=>o.pipe(Object(h.a)((()=>e))))),Object(m.a)(s)),scheduleCD:()=>D(s,n,t)}}function J(e){const t=()=>Object(S.tb)(e.cdRef.context);return{name:"global",detectChanges:t,rxScheduleCD:e=>e,scheduleCD:()=>(t(),new AbortController)}}const z=G();function X(e){const t=e.cdRef.context,n=L.animationFrame,o=H[n],s=()=>{e.cdRef.reattach(),e.cdRef.detectChanges(),e.cdRef.detach()};return{name:"detach",detectChanges:s,rxScheduleCD:e=>e.pipe(R(z,t),Object(d.a)((e=>o.pipe(Object(h.a)((()=>e))))),Object(m.a)(s)),scheduleCD:()=>D(s,n,t)}}let q=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)}}),e})(),W=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)}}),e})(),Y=(()=>{class e{constructor(e){var t;this.templateObserver={suspense:()=>this.renderedValue=void 0,next:e=>this.renderedValue=e},this.RenderAware=function(e){const t=new c.a(1);let n;const o=t.pipe(Object(p.a)(),Object(d.a)((e=>"string"==typeof e?Object(a.a)(e):e)),Object(h.a)((t=>{const n=e.strategies[t];if(n)return n;throw new Error(`Strategy ${t} does not exist.`)})),Object(m.a)((e=>n=e)),Object(g.a)({bufferSize:1,refCount:!0})),s=new c.a(1),b=s.pipe(Object(p.a)());let l=!0;const u=b.pipe(Object(h.a)((t=>null===t?Object(a.a)(null):l||(e.templateObserver.suspense(),void 0!==t)?(l=!1,t):Object(a.a)(void 0))),Object(O.a)((e=>void 0!==e)),Object(p.a)(),Object(d.a)((t=>{return t.pipe(Object(p.a)(),Object(m.a)(e.templateObserver),(n=o,e=>e.pipe((e=>new r.a((t=>{const n=e.subscribe({next:e=>t.next(e),error:e=>{console.error(e),t.next()},complete:()=>t.next()});return()=>n.unsubscribe()}))),function(...e){return t=>{let n;return"function"==typeof e[e.length-1]&&(n=e.pop()),t.lift(new y(e,n))}}(n),Object(d.a)((([e,t])=>Object(a.a)(e).pipe(t.rxScheduleCD))))));var n})));return{nextPotentialObservable(e){s.next(e)},nextStrategy(e){t.next(e)},activeStrategy$:o,subscribe:()=>(new i.a).add(u.subscribe())}}({strategies:(t={cdRef:e},Object.assign(Object.assign(Object.assign(Object.assign({},function(e){return{local:Q(e)}}(t)),function(e){return{global:J(e)}}(t)),function(e){return{detach:X(e)}}(t)),{noop:{name:"noop",detectChanges:()=>{},rxScheduleCD:e=>e,scheduleCD:()=>new AbortController},native:B(t)})),templateObserver:this.templateObserver}),this.subscription=this.RenderAware.subscribe()}transform(e,t){return this.RenderAware.nextStrategy(t||"local"),this.RenderAware.nextPotentialObservable(e),this.renderedValue}ngOnDestroy(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(S.Wb())},e.\u0275pipe=S.Kb({name:"push",type:e,pure:!1}),e})(),Z=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)},imports:[[]]}),e})(),K=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)},imports:[q,Z,V,W]}),e})();var ee=n("jxfh"),te=n("PCNd"),ne=n("sEIs"),oe=n("D57K"),se=n("3p4X"),re=n("5uGe"),ie=n("Efrr");class ce{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new ae(e,this.dueTime,this.scheduler))}}class ae extends re.a{constructor(e,t,n){super(e),this.dueTime=t,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(be,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function be(e){e.debouncedNext()}var le=n("jIqt"),ue=n("cJ9h"),pe=n("J+dc"),de=n("l3rL"),he=n("SKbq");let me=(()=>{class e{copyText(e){const t=this.createInputElement();t.style.opacity="0",t.style["text-indent"]="-9999px",document.body.appendChild(t),this.setInputValue(t,e),this.selectInput(t),document.execCommand("copy"),this.removeElement(t)}createInputElement(){return document.createElement("input")}selectInput(e){e.select(),e.setSelectionRange(0,99999)}setInputValue(e,t){e.value=t}removeElement(e){e.blur(),e.remove()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=S.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ge=n("jJz7"),Oe=n("3k0i"),fe=n("F5nt"),je=n("PJjB");let ye=(()=>{class e{constructor(e){this.pokerService=e}createRoom(){return this.pokerService.createRoom()}joinRoom(e){this.pokerService.joinRoom(e,de.d.HOST)}getPlayers(){return this.pokerService.getPlayers()}getResults(){return this.pokerService.getResults()}getGameState(){return this.pokerService.getGameState()}toggleGameState(e){return this.pokerService.toggleGameState(e)}closeRoom(e){this.pokerService.closeRoom(e)}playerVoted(){return this.pokerService.playerVoted()}getIsHostOfRoom(e){return this.pokerService.getIsHostOfRoom(e)}}return e.\u0275fac=function(t){return new(t||e)(S.Ub(je.a))},e.\u0275prov=S.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ve;!function(e){class t{}t.type="[HostActions] Host board initialization",e.HostBoardInit=t;class n{}n.type="[HostActions] Create room",e.CreateRoom=n;class o{}o.type="[HostActions] Toggle Game State",e.ToggleGameState=o;class s{}s.type="[HostActions] Join room",e.JoinRoom=s;class r{}r.type="[HostActions] Get players",e.GetPlayers=r;class i{}i.type="[HostActions] Get results",e.GetResults=i;class c{}c.type="[HostActions] Get game state",e.GetGameState=c;class a{}a.type="[HostActions] Copy room link",e.CopyRoomLink=a;class b{}b.type="[HostActions] Close room",e.CloseRoom=b;class l{}l.type="[HostActions] Get player status",e.GetPlayerStatus=l}(ve||(ve={}));var Se=n("kuMc"),Ce=n("67b8"),we=n("PKRn"),ke=ve.CloseRoom,xe=ve.CreateRoom,Re=ve.GetGameState,Pe=ve.GetPlayers,Ie=ve.JoinRoom,_e=ve.ToggleGameState,Te=ve.HostBoardInit,Me=ve.CopyRoomLink,$e=ve.GetPlayerStatus,Ae=ve.GetResults;let Ne=(()=>{let e=class{constructor(e,t,n){this.hostService=e,this.$gaService=t,this.actions$=n}static gameState(e){return e.gameState}static roomNumber(e){return e.roomNumber}static players(e){return Array.from(e.players.values())}hostBoardInit(){this.$gaService.pageView("/host/board")}createRoom(e){return this.hostService.createRoom().pipe(Object(m.a)((t=>{const n=e.getState();e.setState(Object.assign(Object.assign({},n),{roomNumber:t.id,gameState:t.gameState}))})),Object(ue.a)((()=>e.dispatch(new Ie))))}toggleHostState(e){this.$gaService.event("toggle_game_state","host","Toggle game state");const t=e.getState();this.hostService.toggleGameState(t.roomNumber)}joinRoom(e){const t=e.getState();this.hostService.joinRoom(t.roomNumber)}getUsers(e){this.hostService.getPlayers().pipe(Object(Se.a)(this.actions$.pipe(Object(s.j)(ke)))).subscribe((t=>{const n=new Map;t.forEach((t=>{const o=this.getPlayerData(e,t.id);n.set(t.id,Object.assign(Object.assign({},o),t))})),e.patchState({players:n})}))}getResults(e){this.hostService.getResults().pipe(Object(Se.a)(this.actions$.pipe(Object(s.j)(ke)))).subscribe((t=>{const n=e.getState().players;n&&n.size&&(n.forEach(((e,o)=>{const s=t[o]||null;e.card=s&&s.card,n.set(o,e)})),e.patchState({players:n}))}))}getGameState(e){this.hostService.getGameState().pipe(Object(Se.a)(this.actions$.pipe(Object(s.j)(ke)))).subscribe((t=>{t===de.b.IN_PROGRESS&&this.resetPlayersVotes(e),e.patchState({gameState:t})}))}getPlayerStatus(e){this.hostService.playerVoted().pipe(Object(Se.a)(this.actions$.pipe(Object(s.j)(ke)))).subscribe((t=>{const n=e.getState().players,o=n.get(t);o&&(o.status=de.c.VOTED,n.set(t,o)),e.patchState({players:n})}))}copyRoomLink(){this.$gaService.event("copy_room_link","host","Copy room link")}closeRoom(e){const t=e.getState();this.$gaService.event("close_room","host","Close room"),this.hostService.closeRoom(t.roomNumber)}resetPlayersVotes(e){const t=e.getState().players;t&&t.size&&(t.forEach(((e,n)=>{e.status=de.c.WAITING,e.card=null,t.set(n,e)})),e.patchState({players:t}))}getPlayerData(e,t){const n=e.getState().players;return n&&n.get(t)||null}};return e.\u0275fac=function(t){return new(t||e)(S.Ub(ye),S.Ub(we.a),S.Ub(s.b))},e.\u0275prov=S.Hb({token:e,factory:e.\u0275fac}),Object(oe.b)([Object(s.a)(Te),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[]),Object(oe.c)("design:returntype",void 0)],e.prototype,"hostBoardInit",null),Object(oe.b)([Object(s.a)(xe),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",r.a)],e.prototype,"createRoom",null),Object(oe.b)([Object(s.a)(_e),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"toggleHostState",null),Object(oe.b)([Object(s.a)(Ie),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"joinRoom",null),Object(oe.b)([Object(s.a)(Pe),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"getUsers",null),Object(oe.b)([Object(s.a)(Ae),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"getResults",null),Object(oe.b)([Object(s.a)(Re),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"getGameState",null),Object(oe.b)([Object(s.a)($e),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"getPlayerStatus",null),Object(oe.b)([Object(s.a)(Me),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[]),Object(oe.c)("design:returntype",void 0)],e.prototype,"copyRoomLink",null),Object(oe.b)([Object(s.a)(ke),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",void 0)],e.prototype,"closeRoom",null),Object(oe.b)([Object(s.f)(),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",String)],e,"gameState",null),Object(oe.b)([Object(s.f)(),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",String)],e,"roomNumber",null),Object(oe.b)([Object(s.f)(),Object(oe.c)("design:type",Function),Object(oe.c)("design:paramtypes",[Object]),Object(oe.c)("design:returntype",Array)],e,"players",null),e=Object(oe.b)([Object(s.g)({name:Ce.a.HOST,defaults:{roomNumber:null,gameState:de.b.IN_PROGRESS,players:new Map}})],e),e})();var Fe=n("jOdJ");class Ee{constructor(e,t){this.store=e,this.router=t}navigateToHomePage(){this.router.navigateByUrl("/")}hasRoomNumber(){return this.store.select(Ne.roomNumber).pipe(Object(h.a)((e=>!!e)))}}let Ge=(()=>{class e extends Ee{constructor(e,t){super(e,t),this.discardSubject=new u.a}canActivate(){return this.hasRoomNumber().pipe(Object(h.a)((e=>e)),Object(m.a)((e=>{e||this.navigateToHomePage()})))}canDeactivate(e,t,n,o){return"/?reconnectFailed=true"===o.url||(e.showLeaveModal(),this.discardSubject.asObservable().pipe(Object(Fe.a)()))}discard(){this.discardSubject.next(!0),setTimeout((()=>{this.discardSubject.next(!0)}))}keep(){this.discardSubject.next(!1)}}return e.\u0275fac=function(t){return new(t||e)(S.Ub(s.h),S.Ub(ne.c))},e.\u0275prov=S.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var He=n("guRg"),De=n("XaqE"),Ve=n("XQRf"),Be=n("Azit"),Le=ve.CloseRoom,Ue=ve.GetGameState,Qe=ve.GetPlayers,Je=ve.ToggleGameState,ze=ve.HostBoardInit,Xe=ve.CopyRoomLink,qe=ve.GetPlayerStatus,We=ve.GetResults;function Ye(e,t){1&e&&(S.Ob(0),S.nc(1,"New voting"),S.Nb())}function Ze(e,t){1&e&&(S.Ob(0),S.nc(1,"Finish Voting"),S.Nb())}function Ke(e,t){1&e&&(S.Ob(0),S.nc(1,"Get room link"),S.Nb())}function et(e,t){1&e&&(S.Ob(0),S.nc(1,"Link copied"),S.Nb())}function tt(e,t){if(1&e){const e=S.Rb();S.Qb(0,"div",12),S.Mb(1,"div",13),S.Qb(2,"div",14),S.Qb(3,"p"),S.nc(4," Are you sure to end this session? "),S.Pb(),S.Qb(5,"footer",15),S.Qb(6,"button",10),S.Xb("click",(function(){return S.jc(e),S.Zb().leaveModalAction(!0)})),S.nc(7," YES "),S.Pb(),S.Qb(8,"button",10),S.Xb("click",(function(){return S.jc(e),S.Zb().leaveModalAction(!1)})),S.nc(9," NO "),S.Pb(),S.Pb(),S.Pb(),S.Pb()}if(2&e){const e=S.Zb();S.Bb(6),S.fc("buttonColor",e.buttonColors.ACCENT),S.Bb(2),S.fc("buttonColor",e.buttonColors.ACCENT)}}let nt=(()=>{let e=class{constructor(e,t,n,o,s,r,i){this.boardGuard=e,this.hostService=t,this.appService=n,this.router=o,this.environmentService=s,this.copyToClipboardService=r,this.store=i,this.gameStates=de.b,this.buttonColors=ee.a,this.leaveModalVisibilitySubject$=new l.a(!1),this.leaveModalVisibility$=this.leaveModalVisibilitySubject$.asObservable(),this.linkCopiedSubject$=new l.a(!1),this.linkCopied$=this.linkCopiedSubject$.asObservable()}ngOnInit(){this.dispatchOnInitActions(),this.store.dispatch(new ze),this.currentTime$=this.getCurrentTime$(),this.handleSocketEvents(),this.handleIntervalHostCheck()}ngOnDestroy(){this.dispatchOnDestroyActions()}toggleGameState(){this.store.dispatch(new Je)}closeRoom(){this.router.navigateByUrl("/")}set leaveModalVisibility(e){this.leaveModalVisibilitySubject$.next(e)}get roomLink(){const e=this.store.selectSnapshot(Ne.roomNumber);return window.location.origin+"/guest/room-code?code="+e}copyToClipboardRoomLink(){this.store.dispatch(new Xe),this.copyToClipboardService.copyText(this.roomLink),this.linkCopiedSubject$.next(!0),this.linkCopied$.pipe(function(e,t=ie.a){return n=>n.lift(new ce(e,t))}(2e3),Object(O.a)((e=>e)),Object(he.d)(this)).subscribe((()=>{this.linkCopiedSubject$.next(!1)}))}showLeaveModal(){this.leaveModalVisibility=!0}closeLeaveModal(){this.leaveModalVisibility=!1}leaveModalAction(e){e?this.boardGuard.discard():this.boardGuard.keep(),this.closeLeaveModal()}isPlayerReady(e){return e.status===de.c.VOTED}beforeUnloadHandler(){if(this.environmentService.production)return!1}dispatchOnInitActions(){this.store.dispatch([new Qe,new We,new Ue,new qe])}dispatchOnDestroyActions(){this.store.dispatch(new Le)}getCurrentTime$(){return Object(se.a)(1e3).pipe(Object(le.a)(null),Object(h.a)((()=>new Date)))}handleSocketEvents(){this.appService.reconnectFailed$.pipe(Object(he.d)(this)).subscribe((()=>{this.router.navigateByUrl("/?reconnectFailed=true")})),this.appService.connect$.pipe(Object(ue.a)((()=>this.roomNumber$)),Object(pe.a)(1),Object(ue.a)((e=>this.getIfIsHostOfRoom(e))),Object(he.d)(this)).subscribe((()=>this.router.navigateByUrl("/?reconnectFailed=true")))}getIfIsHostOfRoom(e){return this.hostService.getIsHostOfRoom(e).pipe(Object(O.a)((e=>!e)))}handleIntervalHostCheck(){Object(se.a)(3e4).pipe(Object(ue.a)((()=>this.connectionStatus$.pipe(Object(pe.a)(1)))),Object(O.a)((e=>e===he.b.CONNECTED)),Object(ue.a)((()=>this.roomNumber$.pipe(Object(pe.a)(1)))),Object(ue.a)((e=>this.getIfIsHostOfRoom(e))),Object(he.d)(this)).subscribe((()=>this.router.navigateByUrl("/?reconnectFailed=true")))}};return e.\u0275fac=function(t){return new(t||e)(S.Lb(Ge),S.Lb(ye),S.Lb(fe.a),S.Lb(ne.c),S.Lb(ge.a),S.Lb(me),S.Lb(s.h))},e.\u0275cmp=S.Fb({type:e,selectors:[["planning-poker-board"]],hostBindings:function(e,t){1&e&&S.Xb("beforeunload",(function(){return t.beforeUnloadHandler()}),!1,S.ic)},decls:25,vars:25,consts:[[3,"players$","gameState$"],[1,"sidebar"],[1,"sidebar-header"],["haxitTextFixedWidth",""],[1,"clock",3,"value"],[1,"sidebar-footer"],["haxit-button","",1,"toggle-game-state",3,"buttonColor","ngSwitch","click"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["haxit-button","",3,"buttonColor","ngSwitch","click"],["haxit-button","",3,"buttonColor","click"],["class","modal-container",4,"ngIf"],[1,"modal-container"],[1,"modal-overlay"],[1,"modal-content"],[1,"modal-footer"]],template:function(e,t){1&e&&(S.Mb(0,"planning-poker-table",0),S.Qb(1,"div",1),S.Qb(2,"header",2),S.Qb(3,"h1"),S.nc(4,"ROOM ID:"),S.Pb(),S.Qb(5,"h2",3),S.nc(6),S.ac(7,"push"),S.Pb(),S.Mb(8,"haxit-text-fixed-width",4),S.ac(9,"date"),S.ac(10,"push"),S.Pb(),S.Qb(11,"footer",5),S.Qb(12,"button",6),S.Xb("click",(function(){return t.toggleGameState()})),S.ac(13,"push"),S.mc(14,Ye,2,0,"ng-container",7),S.mc(15,Ze,2,0,"ng-container",8),S.Pb(),S.Qb(16,"button",9),S.Xb("click",(function(){return t.copyToClipboardRoomLink()})),S.ac(17,"push"),S.mc(18,Ke,2,0,"ng-container",8),S.mc(19,et,2,0,"ng-container",7),S.Pb(),S.Qb(20,"button",10),S.Xb("click",(function(){return t.closeRoom()})),S.Ob(21),S.nc(22,"Close room"),S.Nb(),S.Pb(),S.Pb(),S.Pb(),S.mc(23,tt,10,2,"div",11),S.ac(24,"push")),2&e&&(S.fc("players$",t.players$)("gameState$",t.gameState$),S.Bb(6),S.oc(S.bc(7,12,t.roomNumber$)),S.Bb(2),S.fc("value",S.cc(9,14,S.bc(10,17,t.currentTime$),"HH:mm")),S.Bb(4),S.fc("buttonColor",t.buttonColors.PRIMARY)("ngSwitch",S.bc(13,19,t.gameState$)),S.Bb(2),S.fc("ngSwitchCase",t.gameStates.REVIEW),S.Bb(2),S.fc("buttonColor",t.buttonColors.SECONDARY)("ngSwitch",S.bc(17,21,t.linkCopied$)),S.Bb(3),S.fc("ngSwitchCase",!0),S.Bb(1),S.fc("buttonColor",t.buttonColors.INACTIVE),S.Bb(3),S.fc("ngIf",S.bc(24,23,t.leaveModalVisibility$)))},directives:[He.a,De.a,Ve.a,Be.a,o.l,o.m,o.n,o.k],pipes:[Y,o.e],styles:["[_nghost-%COMP%]{padding:0 1.1111111111em;width:100%;flex-direction:row;flex-wrap:nowrap}.sidebar[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;display:flex;justify-content:flex-start;align-content:stretch;align-items:flex-start}.sidebar[_ngcontent-%COMP%]{order:0;flex:0 0 27%;align-self:auto;flex-direction:column;flex-wrap:nowrap;padding-top:2.5em;padding-left:.8333333333em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{order:0;flex:1 1 auto;align-self:auto;display:flex;flex-direction:column;width:100%}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8333333333em;letter-spacing:.0833333333em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.8888888889em}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .clock[_ngcontent-%COMP%]{margin-top:auto;margin-left:auto;color:#fff;font-size:1.8333333333em;font-weight:700}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:flex-start;width:100%}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:1.6666666667em 0;width:100%}"]}),Object(oe.b)([Object(s.e)(Ne.gameState),Object(oe.c)("design:type",r.a)],e.prototype,"gameState$",void 0),Object(oe.b)([Object(s.e)(Ne.roomNumber),Object(oe.c)("design:type",r.a)],e.prototype,"roomNumber$",void 0),Object(oe.b)([Object(s.e)(Ne.players),Object(oe.c)("design:type",r.a)],e.prototype,"players$",void 0),Object(oe.b)([Object(s.e)(Oe.a.connectionStatus),Object(oe.c)("design:type",r.a)],e.prototype,"connectionStatus$",void 0),e=Object(oe.b)([Object(he.c)()],e),e})();var ot=n("FU6l"),st=n("ckkg");class rt{call(e,t){return t.subscribe(new it(e))}}class it extends f.a{constructor(e){super(e),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(e){this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(let n=0;n<t&&!this.hasFirst;n++){let t=e[n],o=Object(j.a)(this,t,t,n);this.subscriptions&&this.subscriptions.push(o),this.add(o)}this.observables=null}}notifyNext(e,t,n,o,s){if(!this.hasFirst){this.hasFirst=!0;for(let e=0;e<this.subscriptions.length;e++)if(e!==n){let t=this.subscriptions[e];t.unsubscribe(),this.remove(t)}this.subscriptions=null}this.destination.next(t)}}var ct=n("BwBJ"),at=n("l/sm"),bt=ve.CreateRoom;const lt=[{path:"wait",component:(()=>{let e=class{constructor(e,t,n,o){this.router=e,this.appService=t,this.store=n,this.$gaService=o}ngOnInit(){this.$gaService.pageView("/host/board"),function(...e){if(1===e.length){if(!Object(ot.a)(e[0]))return e[0];e=e[0]}return Object(st.a)(e,void 0).lift(new rt)}(this.connectionStatus$.pipe(Object(h.a)((e=>e===he.b.DISCONNECTED?(this.appService.reconnectSocket(),null):e)),Object(O.a)((e=>e===he.b.CONNECTED)),Object(pe.a)(1)),Object(a.a)(null).pipe(Object(ct.a)(15e3),Object(h.a)((()=>{throw new Error("timeout")})))).pipe(Object(ue.a)((()=>this.store.dispatch(new bt))),Object(ct.a)(1500),Object(he.d)(this)).subscribe((()=>this.router.navigateByUrl("/host/board")),(e=>this.handleSocketTimeout(e)))}handleSocketTimeout(e){console.error("Error of socket due to",e),this.router.navigateByUrl("/")}};return e.\u0275fac=function(t){return new(t||e)(S.Lb(ne.c),S.Lb(fe.a),S.Lb(s.h),S.Lb(we.a))},e.\u0275cmp=S.Fb({type:e,selectors:[["planning-poker-wait"]],decls:4,vars:0,consts:[[1,"loop-loader"]],template:function(e,t){1&e&&(S.Qb(0,"haxit-icon",0),S.nc(1," loop\n"),S.Pb(),S.Qb(2,"p"),S.nc(3,"Creating room..."),S.Pb())},directives:[at.a],styles:["@keyframes rotate{0%{transform:rotate(1turn)}50%{transform:rotate(180deg)}to{transform:rotate(0deg)}}[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}p[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase;font-size:1em;font-weight:700}.loop-loader[_ngcontent-%COMP%]     .material-icons{font-size:2.7777777778em;animation-name:rotate;animation-duration:1s;animation-iteration-count:infinite}"]}),Object(oe.b)([Object(s.e)(Oe.a.connectionStatus),Object(oe.c)("design:type",r.a)],e.prototype,"connectionStatus$",void 0),e=Object(oe.b)([Object(he.c)()],e),e})(),canActivate:[(()=>{class e extends Ee{constructor(e,t){super(e,t)}canActivate(){return this.hasRoomNumber().pipe(Object(h.a)((e=>!e)),Object(m.a)((e=>{e||this.navigateToHomePage()})))}}return e.\u0275fac=function(t){return new(t||e)(S.Ub(s.h),S.Ub(ne.c))},e.\u0275prov=S.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()],data:{animation:"WaitComponent"}},{path:"board",component:nt,canActivate:[Ge],canDeactivate:[Ge],data:{animation:"BoardComponent"}},{path:"**",redirectTo:"wait"}];let ut=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)},imports:[[ne.d.forChild(lt)],ne.d]}),e})(),pt=(()=>{class e{}return e.\u0275mod=S.Jb({type:e}),e.\u0275inj=S.Ib({factory:function(t){return new(t||e)},imports:[[o.c,ut,ee.c,te.a,s.d.forFeature([Ne]),K]]}),e})()}}]);